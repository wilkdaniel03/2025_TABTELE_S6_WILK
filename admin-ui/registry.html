<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Container Registry - Admin UI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f6f8;
            padding: 30px;
        }

        h1 {
            margin-bottom: 20px;
        }

        select {
            padding: 6px;
            min-width: 300px;
        }

        table {
            margin-top: 20px;
            border-collapse: collapse;
            background: #fff;
            min-width: 400px;
        }

        th, td {
            border: 1px solid #ccc;
            padding: 8px 12px;
            text-align: left;
        }

        th {
            background: #eee;
        }
    </style>
</head>
<body>

    <h1>Private Container Registry – Admin UI</h1>

    <label for="repoSelect"><strong>Repository:</strong></label><br>
    <select id="repoSelect">
        <option value="">-- select repository --</option>
    </select>

    <table id="tagsTable" style="display:none">
        <thead>
            <tr>
                <th>Tag</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const REGISTRY = "http://51.68.145.72:5000";

        async function loadRepositories() {
            const select = document.getElementById("repoSelect");

            const res = await fetch(`${REGISTRY}/v2/_catalog`);
            const data = await res.json();

            data.repositories.forEach(repo => {
                const opt = document.createElement("option");
                opt.value = repo;
                opt.textContent = repo;
                select.appendChild(opt);
            });
        }

        async function loadTags(repo) {
            const table = document.getElementById("tagsTable");
            const tbody = table.querySelector("tbody");
            tbody.innerHTML = "";

            if (!repo) {
                table.style.display = "none";
                return;
            }

            const res = await fetch(`${REGISTRY}/v2/${repo}/tags/list`);
            const data = await res.json();

            (data.tags || []).forEach(tag => {
                const tr = document.createElement("tr");
                const td = document.createElement("td");
                td.textContent = tag;
                tr.appendChild(td);
                tbody.appendChild(tr);
            });

            table.style.display = "table";
        }

        document.getElementById("repoSelect").addEventListener("change", e => {
            loadTags(e.target.value);
        });

        loadRepositories();
    </script>

</body>
</html>
